@model ELDNET.Models.ApprovalViewModel

@{
    ViewData["Title"] = "Approvals";
}

<div class="container py-5">
    <div class="text-center mb-5">
        <h2 class="display-5 fw-bold text-gradient-blue">
            <i class="bi bi-patch-check-fill me-3"></i>Approval Dashboard
        </h2>
        <p class="lead text-muted mt-3">Manage and review all pending, approved, and denied requests efficiently.</p>
    </div>

    <div class="custom-card shadow-lg border-0">
        <div class="card-header bg-white p-0 border-bottom-0">
            <ul class="nav nav-tabs custom-tabs" id="approvalTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active tab-blue" id="gatePass-tab" data-bs-toggle="tab" data-bs-target="#gatePassContent" type="button" role="tab" aria-controls="gatePassContent" aria-selected="true">
                        <i class="bi bi-person-walking me-2"></i>Gate Pass Requests
                        <span class="badge bg-primary-gradient ms-2 rounded-pill">@(Model.GatePasses?.Count(gp => gp.Status == "Pending") ?? 0)</span>
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link tab-green" id="activityRes-tab" data-bs-toggle="tab" data-bs-target="#activityResContent" type="button" role="tab" aria-controls="activityResContent" aria-selected="false">
                        <i class="bi bi-calendar-check-fill me-2"></i>Activity Reservations
                        <span class="badge bg-success-gradient ms-2 rounded-pill">@(Model.ActivityReservations?.Count(ar => ar.Status == "Pending") ?? 0)</span>
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link tab-yellow" id="lockerReq-tab" data-bs-toggle="tab" data-bs-target="#lockerReqContent" type="button" role="tab" aria-controls="lockerReqContent" aria-selected="false">
                        <i class="bi bi-lock-fill me-2"></i>Locker Requests
                        <span class="badge bg-warning-gradient ms-2 rounded-pill text-dark">@(Model.LockerRequests?.Count(lr => lr.Status == "Pending") ?? 0)</span>
                    </button>
                </li>
            </ul>
        </div>
        <div class="card-body p-4 p-lg-5">
            <div class="tab-content" id="approvalTabsContent">
                <!-- Gate Pass Requests Tab Content -->
                <div class="tab-pane fade show active" id="gatePassContent" role="tabpanel" aria-labelledby="gatePass-tab">
                    @if (Model.GatePasses != null && Model.GatePasses.Any())
                    {
                        <div class="table-responsive">
                            <table class="table table-hover align-middle mb-0">
                                <thead class="table-light">
                                    <tr>
                                        <th scope="col">Name</th>
                                        <th scope="col">Department</th>
                                        <th scope="col">Course & Year</th>
                                        <th scope="col">Date</th>
                                        <th scope="col">Status</th>
                                        <th scope="col" class="text-center">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var gp in Model.GatePasses)
                                    {
                                        <tr>
                                            <td>@gp.Name</td>
                                            <td>@gp.Department</td>
                                            <td>@gp.CourseYear</td>
                                            <td>@gp.Date.ToString("yyyy-MM-dd")</td>
                                            <td>
                                                <span class="badge rounded-pill fs-6 px-3 py-2 @(gp.Status == "Approved" ? "bg-success-gradient" : gp.Status == "Denied" ? "bg-danger-gradient" : "bg-warning-gradient text-dark")">
                                                    @gp.Status
                                                </span>
                                            </td>
                                            <td class="text-center">
                                                <a asp-action="Details" asp-route-id="@gp.Id" asp-route-type="GatePass" class="btn btn-info-outline btn-sm px-3">
                                                    <i class="bi bi-eye me-1"></i> Details
                                                </a>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                    }
                    else
                    {
                        <div class="alert alert-info border-0 text-center py-4" role="alert">
                            <i class="bi bi-info-circle-fill me-2"></i>No gate pass requests to display.
                        </div>
                    }
                </div>

                <!-- Activity Reservations Tab Content -->
                <div class="tab-pane fade" id="activityResContent" role="tabpanel" aria-labelledby="activityRes-tab">
                    @if (Model.ActivityReservations != null && Model.ActivityReservations.Any())
                    {
                        <div class="table-responsive">
                            <table class="table table-hover align-middle mb-0">
                                <thead class="table-light">
                                    <tr>
                                        <th scope="col">Organization</th>
                                        <th scope="col">Activity Title</th>
                                        <th scope="col">Venue</th>
                                        <th scope="col">Date</th>
                                        <th scope="col">Status</th>
                                        <th scope="col" class="text-center">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var res in Model.ActivityReservations)
                                    {
                                        <tr>
                                            <td>@res.OrganizationName</td>
                                            <td>@res.ActivityTitle</td>
                                            <td>@res.Venue</td>
                                            <td>@res.ActivityDate.ToString("yyyy-MM-dd")</td>
                                            <td>
                                                <span class="badge rounded-pill fs-6 px-3 py-2 @(res.Status == "Approved" ? "bg-success-gradient" : res.Status == "Denied" ? "bg-danger-gradient" : "bg-warning-gradient text-dark")">
                                                    @res.Status
                                                </span>
                                            </td>
                                            <td class="text-center">
                                                <a asp-action="Details" asp-route-id="@res.Id" asp-route-type="Reservation" class="btn btn-info-outline btn-sm px-3">
                                                    <i class="bi bi-eye me-1"></i> Details
                                                </a>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                    }
                    else
                    {
                        <div class="alert alert-success border-0 text-center py-4" role="alert">
                            <i class="bi bi-info-circle-fill me-2"></i>No activity reservations to display.
                        </div>
                    }
                </div>

                <!-- Locker Requests Tab Content -->
                <div class="tab-pane fade" id="lockerReqContent" role="tabpanel" aria-labelledby="lockerReq-tab">
                    @if (Model.LockerRequests != null && Model.LockerRequests.Any())
                    {
                        <div class="table-responsive">
                            <table class="table table-hover align-middle mb-0">
                                <thead class="table-light">
                                    <tr>
                                        <th scope="col">Name</th>
                                        <th scope="col">Locker Number</th>
                                        <th scope="col">Semester</th>
                                        <th scope="col">Contact</th>
                                        <th scope="col">Status</th>
                                        <th scope="col" class="text-center">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var locker in Model.LockerRequests)
                                    {
                                        <tr>
                                            <td>@locker.Name</td>
                                            <td>@locker.LockerNumber</td>
                                            <td>@locker.Semester</td>
                                            <td>@locker.ContactNumber</td>
                                            <td>
                                                <span class="badge rounded-pill fs-6 px-3 py-2 @(locker.Status == "Approved" ? "bg-success-gradient" : locker.Status == "Denied" ? "bg-danger-gradient" : "bg-warning-gradient text-dark")">
                                                    @locker.Status
                                                </span>
                                            </td>
                                            <td class="text-center">
                                                <a asp-action="Details" asp-route-id="@locker.Id" asp-route-type="Locker" class="btn btn-info-outline btn-sm px-3">
                                                    <i class="bi bi-eye me-1"></i> Details
                                                </a>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                    }
                    else
                    {
                        <div class="alert alert-warning border-0 text-center py-4" role="alert">
                            <i class="bi bi-info-circle-fill me-2"></i>No locker requests to display.
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>